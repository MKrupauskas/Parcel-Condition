<!DOCTYPE html>
<html>
  <head>
    <title>Parcel Condition Telia IoT Hackathon 2017</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Overpass" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script language="javascript" type="text/javascript" src="libraries/p5.js"></script>
    <script language="javascript" src="libraries/p5.dom.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="sketch.js"></script>
  </head>
  <body>
    <div id="title">
      <h1><a href="SecondInterfaceVersion\second.html">Your Package</a></h1>
    </div>
    <div id="map"></div>
    <div id="canvasDiv"></div>
    <script>
    let mapProp;
    let map;
    let marker;
    let coordLat = 0;
    let coordLng = 0;
    let data;

    getData();
    setInterval(changeData, 2000);


    function changeData () {
      getData();
      let latlng = new google.maps.LatLng(coordLat, coordLng);
      marker.setPosition(latlng);
    }

    function getData () {
      $.ajax({
        url: "data.json",
        async: false,
        success: function(tempData) {
          data = tempData;
        },
        dataType: "json",
        complete: function() {
          coordLat = data.live["2"];
          coordLng = data.live["3"];
        }
      });
    }

    function initMap() {
      mapProp = {
        center: new google.maps.LatLng(coordLat, coordLng),
        zoom: 16,
        styles: [
          { featureType: "all", elementType: "all", stylers: [{ hue: "#008eff" }] },
          {
            featureType: "poi",
            elementType: "all",
            stylers: [{ visibility: "off" }]
          },
          {
            featureType: "road",
            elementType: "all",
            stylers: [{ saturation: "0" }, { lightness: "0" }]
          },
          {
            featureType: "transit",
            elementType: "all",
            stylers: [{ visibility: "off" }]
          },
          {
            featureType: "water",
            elementType: "all",
            stylers: [
              { visibility: "simplified" },
              { saturation: "-60" },
              { lightness: "-20" }
            ]
          }
        ]
      };
      map = new google.maps.Map(document.getElementById("map"), mapProp);
      marker = new google.maps.Marker({
        position: mapProp.center,
        icon: "images/test.png"
      });
      marker.setMap(map);
    }

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6ptOYFDBKkUQmlJgwSla1apd3tN4RknI&callback=initMap"
    async defer></script>
    <h3>Telia IoT hackathon 2017</h3>
  </body>
</html>
