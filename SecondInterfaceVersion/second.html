<!DOCTYPE html>
<html lang="lt">
  <head>
    <title>Second Interface</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Overpass" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  </head>
  <body>
	<div id="switch">
	    <h1><a href="../index.html">Your Package</a></h1>
	</div>
	<div id="legend"></div>

  <div id="map"></div>
  <script>
let map;
let data;

$.ajax({
	url: '../data.json',
	async: false,
	success: function(tempData) {
		data = tempData;
	},
	dataType: 'json',
});

let legend = document.getElementById('legend');
let coordLat = data['live']['2'];
let coordLng = data['live']['3'];
let infoWindowContent =
	"<div id='infoBox'><p>latitude: " +
	coordLat +
	'<br/>longitude: ' +
	coordLng +
	'</p></div>';


function initMap() {
	map = new google.maps.Map(document.getElementById('map'), {
		zoom: 16,
		mapTypeId: google.maps.MapTypeId.ROADMAP,
		disableDefaultUI: true,
		zoomControl: true,
		center: { lat: data['live']['2'], lng: data['live']['3'] },
		styles: [
			{ featureType: 'all', elementType: 'all', stylers: [{ hue: '#008eff' }] },
			{
				featureType: 'poi',
				elementType: 'all',
				stylers: [{ visibility: 'off' }]
			},
			{
				featureType: 'road',
				elementType: 'all',
				stylers: [{ saturation: '0' }, { lightness: '0' }]
			},
			{
				featureType: 'transit',
				elementType: 'all',
				stylers: [{ visibility: 'off' }]
			},
			{
				featureType: 'water',
				elementType: 'all',
				stylers: [
					{ visibility: 'simplified' },
					{ saturation: '-60' },
					{ lightness: '-20' }
				]
			}
		]
	});

	let marker = new google.maps.Marker({
		position: new google.maps.LatLng(data['live']['2'], data['live']['3']),
		icon: '../images/test.png',
		map: map
	});

	let infoWindow = new google.maps.InfoWindow();
	marker.addListener('click', function(event) {
		infoWindow.setContent(infoWindowContent);
		infoWindow.setPosition(event.latLng);
		infoWindow.open(map);
	});

	var holder = document.createElement('div');
	holder.innerHTML =
		'<p style="font-size:200%;text-align:center;"> <b>Info</b></p></p>';
	legend.appendChild(holder);
	var holder = document.createElement('div');
	holder.innerHTML =
		'<p style="font-size:150%;text-align:center;"><b>Temperature: </b>' +
		data.live['200'] +
		'Â°C</br>  <span>(Optimal)</span></p>';
	legend.appendChild(holder);
	var holder = document.createElement('div');
	holder.innerHTML =
		'<p style="font-size:150%;text-align:center;"><b>Humidity: </b>' +
		Math.round(data.live['220']) +
		'%</br><span>(Optimal)</span></p>';
	legend.appendChild(holder);
	var holder = document.createElement('div');
	holder.innerHTML =
		'<p style="font-size:150%;text-align:center;"><b>Battery: </b>' +
		data.live['10'] +
		'%</br><span>(Optimal)</span></p>';
	legend.appendChild(holder);
	var holder = document.createElement('div');
	holder.innerHTML =
		'<p style="font-size:150%;text-align:center;"><b>Condition: </b><span>Good</span></p>';
	legend.appendChild(holder);

	map.controls[google.maps.ControlPosition.TOP_CENTER].push(
		document.getElementById('switch')
	);
	map.controls[google.maps.ControlPosition.LEFT_CENTER].push(
		document.getElementById('legend')
	);
}
</script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6ptOYFDBKkUQmlJgwSla1apd3tN4RknI&callback=initMap"
    async defer></script>
  </body>
</html>
